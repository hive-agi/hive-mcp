{:paths ["src" "resources"]

 :deps {org.clojure/clojure {:mvn/version "1.12.1"}
        org.clojure/data.json {:mvn/version "2.5.1"}
        org.clojure/core.async {:mvn/version "1.7.701"}

        ;; MCP SDK - BuddhiLW fork with async handler fix
        ;; Fix: p/promise → p/future + discarding-stdout in jsonrpc4clj
        io.github.buddhilw/mcp-clojure-sdk
        {:git/tag "v0.1.0-hive" :git/sha "4cef9dd"
         :exclusions [org.apache.logging.log4j/log4j-slf4j2-impl]}

        ;; nREPL client support
        nrepl/bencode {:mvn/version "1.2.0"}

        ;; Aleph for robust async TCP/networking (replaces custom sockets)
        aleph/aleph {:mvn/version "0.9.3"}
        manifold/manifold {:mvn/version "0.5.0"}

        ;; Logic programming for swarm hivemind coordination
        org.clojure/core.logic {:mvn/version "1.1.1"}

        ;; Time handling
        clj-time/clj-time {:mvn/version "0.15.2"}

        ;; Datascript for in-memory graph storage (GraphStore backend)
        datascript/datascript {:mvn/version "1.7.3"}

        ;; Datalevin for durable graph storage (GraphStore backend, optional)
        ;; LMDB-backed Datalog — requires Java 21+
        datalevin/datalevin {:mvn/version "0.10.2"}

        ;; Datahike for immutable graph storage with branching/time-travel
        ;; Content-addressable, supports branch/merge for multi-ling exploration
        ;; Part of replikativ ecosystem (pairs with yggdrasil)
        org.replikativ/datahike {:mvn/version "0.7.1638"}

        ;; Logging - SLF4J with Logback backend
        ;; clojure.tools.logging provides the Clojure facade
        ;; logback-classic is the SLF4J implementation
        ;; logstash-encoder provides JSON output for Loki/ELK ingestion
        org.clojure/tools.logging {:mvn/version "1.3.0"}
        ch.qos.logback/logback-classic {:mvn/version "1.5.16"}
        net.logstash.logback/logstash-logback-encoder {:mvn/version "7.4"}
        ;; Keep Timbre for gradual migration (existing code uses it)
        ;; It will log to its own backend, not SLF4J
        com.taoensso/timbre {:mvn/version "6.8.0"}

        ;; Schema validation for org-clj
        metosin/malli {:mvn/version "0.16.4"}

        ;; Chroma vector database client - BuddhiLW fork with v2 API support
        io.github.buddhilw/clojure-chroma-client
        {:git/tag "v0.1.0-hive" :git/sha "e575d5a"}

        ;; for openrouter integration
        clj-http/clj-http {:mvn/version "3.13.1"}

        ;; YAML parsing for seed memory frontmatter
        clj-commons/clj-yaml {:mvn/version "1.0.29"}

        ;; D-Bus client for native desktop notifications
        com.lambdaisland/dbus-client {:mvn/version "0.2.15"}

        ;; Development - tracing (hot reload via hive-hot)
        org.clojure/tools.trace {:mvn/version "0.9.0"}

        ;; clj-kondo for code analysis (call graphs, linting)
        ;; Exclude log4j-slf4j2-impl to avoid conflict with slf4j-timbre
        clj-kondo/clj-kondo {:mvn/version "2026.01.12"
                             :exclusions [org.apache.logging.log4j/log4j-slf4j2-impl]}

        ;; hive-events - re-frame inspired event system for JVM
        io.github.hive-agi/hive-events
        {:git/tag "v0.1.0" :git/sha "240a09e"}

        ;; hive-hot - unified hot-reload with events integration
        io.github.hive-agi/hive-hot
        {:git/tag "v0.1.1" :git/sha "65530d1"}

        ;; Prometheus metrics - iapetos provides idiomatic Clojure wrapper
        ;; CLARITY-T: Telemetry first - observable system
        ;; hotspot collector provides JVM metrics (memory, GC, threads)
        clj-commons/iapetos {:mvn/version "0.1.13"}
        io.prometheus/simpleclient_hotspot {:mvn/version "0.16.0"}

        ;; java-diff-utils for proper unified diff computation (hunks, context)
        ;; Used by drone diff protocol for token-efficient diff storage
        io.github.java-diff-utils/java-diff-utils {:mvn/version "4.12"}
        org.replikativ/yggdrasil {:mvn/version "0.1.6"}

        ;; Process execution - babashka.process for CLI wrappers
        ;; Used by overarch, scc, and other CLI tool integrations
        babashka/process {:mvn/version "0.5.22"}}

 :aliases
 {:mcp
  {:exec-fn hive-mcp.server/start!
   :exec-args {}
   :extra-deps {nrepl/nrepl {:mvn/version "1.3.1"}
                cider/cider-nrepl {:mvn/version "0.58.0"}}}

  :dev
  {:extra-paths ["dev" "test"]
   :extra-deps {nrepl/nrepl {:mvn/version "1.3.1"}
                cider/cider-nrepl {:mvn/version "0.58.0"}
                refactor-nrepl/refactor-nrepl {:mvn/version "3.11.0"}}
   ;; Suppress Netty sun.misc.Unsafe warnings on Java 17+
   :jvm-opts ["--add-opens=java.base/jdk.internal.misc=ALL-UNNAMED"
              "--add-opens=java.base/java.nio=ALL-UNNAMED"
              "-Dio.netty.tryReflectionSetAccessible=true"]}

  :nrepl
  {:extra-paths ["dev" "test"]
   :extra-deps {nrepl/nrepl {:mvn/version "1.3.1"}
                cider/cider-nrepl {:mvn/version "0.58.0"}
                refactor-nrepl/refactor-nrepl {:mvn/version "3.11.0"}}
   ;; Suppress Netty sun.misc.Unsafe warnings on Java 17+
   :jvm-opts ["--add-opens=java.base/jdk.internal.misc=ALL-UNNAMED"
              "--add-opens=java.base/java.nio=ALL-UNNAMED"
              "-Dio.netty.tryReflectionSetAccessible=true"]
   :main-opts ["-m" "nrepl.cmdline"
               "--port" "7910"
               "--middleware" "[cider.nrepl/cider-middleware,refactor-nrepl.middleware/wrap-refactor]"]}

  :test
  {:extra-paths ["test"]
   :extra-deps {io.github.cognitect-labs/test-runner
                {:git/tag "v0.5.1" :git/sha "dfb30dd"}
                ;; Generative testing for spec validation
                org.clojure/test.check {:mvn/version "1.1.1"}}
   :main-opts ["-m" "cognitect.test-runner"]}

  ;; CI-friendly: Run only unit tests (excludes tests requiring Emacs)
  :test-unit
  {:extra-paths ["test"]
   :extra-deps {io.github.cognitect-labs/test-runner
                {:git/tag "v0.5.1" :git/sha "dfb30dd"}}
   :main-opts ["-m" "cognitect.test-runner" "-e" ":integration"]
   :exec-fn cognitect.test-runner.api/test
   :exec-args {:excludes [:integration]}}

  ;; Run only integration tests (requires Emacs with emacs-mcp loaded)
  :test-integration
  {:extra-paths ["test"]
   :extra-deps {io.github.cognitect-labs/test-runner
                {:git/tag "v0.5.1" :git/sha "dfb30dd"}}
   :main-opts ["-m" "cognitect.test-runner" "-i" ":integration"]
   :exec-fn cognitect.test-runner.api/test
   :exec-args {:includes [:integration]}}}}
